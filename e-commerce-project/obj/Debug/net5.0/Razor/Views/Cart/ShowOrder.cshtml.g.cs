#pragma checksum "F:\iti courses\mvc\Day2\lab\mvc-ecommerce\e-commerce-project\Views\Cart\ShowOrder.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "5087709216ae3919be0eed35b8dd5a774247c4c9"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Cart_ShowOrder), @"mvc.1.0.view", @"/Views/Cart/ShowOrder.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "F:\iti courses\mvc\Day2\lab\mvc-ecommerce\e-commerce-project\Views\_ViewImports.cshtml"
using e_commerce_project;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "F:\iti courses\mvc\Day2\lab\mvc-ecommerce\e-commerce-project\Views\_ViewImports.cshtml"
using e_commerce_project.Models;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"5087709216ae3919be0eed35b8dd5a774247c4c9", @"/Views/Cart/ShowOrder.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"43d2b6c0324bc10d943d4faa178708e7e5b2a33a", @"/Views/_ViewImports.cshtml")]
    #nullable restore
    public class Views_Cart_ShowOrder : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<dynamic>
    #nullable disable
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
            WriteLiteral("\r\n");
#nullable restore
#line 2 "F:\iti courses\mvc\Day2\lab\mvc-ecommerce\e-commerce-project\Views\Cart\ShowOrder.cshtml"
  
    Layout = "_Layout";

#line default
#line hidden
#nullable disable
            WriteLiteral("\r\n\r\n\r\n<div id=\"main\">\r\n    <div class=\"spinner-grow\" role=\"status\">\r\n        <span class=\"sr-only\">Loading...</span>\r\n    </div>\r\n</div>\r\n\r\n");
            DefineSection("MyScript", async() => {
                WriteLiteral(@"
    <script>
        showOrders();
        function showOrders(){
          $.ajax({
                  url:""/Cart/GetUserOrder/"",
                  success: function(res){
                      //if there is unsubmitted order for that user
                      //display it 
                      //if not
                      //show the user the message
                      if(res.orderExist){
                          drawTable(res.order[0].order.id);
                          fillTable(res);
                          updateCartCount(res.orderCount)
                      }else{
                          $(""#main"").html(""<h1>""+res.msg+""</h1>"")
                      }
                    },
                    error:function(request, status, error){
                        console.log(""sasds"")
                    }
          });
        }
        function drawTable(orderId){
                          $(""#main"").html(`
                            <div class=""container-fluid pt-5"">
");
                WriteLiteral(@"                                    <div class=""row px-xl-5"">
                                        <div class=""col-lg-8 table-responsive mb-5"">
                                            <table class=""table table-bordered text-center mb-0"">
                                                <thead class=""bg-secondary text-dark"">
                                                    <tr>
                                                        <th>Products</th>
                                                        <th>Price</th>
                                                        <th>Quantity</th>
                                                        <th>Total</th>
                                                        <th>Remove</th>
                                                    </tr>
                                                </thead>
                                                <tbody class=""align-middle"">
                       
                                           ");
                WriteLiteral(@"     </tbody>
                                            </table>
                                        </div>
                                        <div class=""col-lg-4"">
                                                <div class=""card-footer border-secondary bg-transparent"">
                                                    <div class=""d-flex justify-content-between mt-2"">
                                                        <h5 class=""font-weight-bold"">Total</h5>
                                                        <h5 class=""font-weight-bold"">$160</h5>
                                                    </div>
                                                    <button onclick=whenSubmit(${orderId}) class=""btn btn-block btn-primary my-3 py-3"">Proceed To Checkout</button>
                                                    <button onclick=whenClear(${orderId}) class=""btn btn-block btn-danger my-3 py-3""> Clear </button>
                                                </div>
        ");
                WriteLiteral(@"                                    </div>
                                        </div>
                                    </div>
                                </div>
                          `);
        }
        function fillTable(res){
                      res.order.forEach(({product:{name,id,price},quantity,orderId})=>{
                              $(""tbody"").append(`
                        <tr>
                            <td class=""align-middle""><img src=""img/product-1.jpg"" alt="""" style=""width: 50px;""> ${name} </td>
                            <td class=""align-middle"">${price}</td>
                            <td class=""align-middle"">
                                <div class=""input-group quantity mx-auto"" style=""width: 100px;"">
                                    <div class=""input-group-btn"">
                                        <button onclick=""whenRemove(${orderId},${id})"" class=""btn btn-sm btn-primary btn-minus"" >
                                        <i class=""fa fa-m");
                WriteLiteral(@"inus""></i>
                                        </button>
                                    </div>
                                    <input type=""text"" class=""form-control form-control-sm bg-secondary text-center"" value=${quantity}>
                                    <div class=""input-group-btn"">
                                        <button onclick=""whenAdd(${id})"" class=""btn btn-sm btn-primary btn-plus"">
                                            <i class=""fa fa-plus""></i>
                                        </button>
                                    </div>
                                </div>
                            </td>
                            <td class=""align-middle""><button class=""btn btn-sm btn-primary""><i class=""fa fa-times""></i></button></td>
                        </tr>
                              `)
                          })
        }
        function whenAdd(productId){
                $.ajax({
                  url:""/Cart/Add/""+productId,
    ");
                WriteLiteral(@"              success: function(result){
                      showOrders()
                    },
                  error: function (request, status, error) {}
                });
        }
        function whenSubmit(orderId){
             $.ajax({
                  url:`/Cart/Submit/${orderId}`,
                  success: function(res){
                      showOrders()
                      updateCartCount("""")
                  }
                 });
        }
        function whenClear(orderId){
                $.ajax({
                  url:`/Cart/Clear/${orderId}`,
                  success: function(result){  
                      showOrders()
                      updateCartCount("""")
                  }
                });
        }
        function whenRemove(orderId,productId){
              $.ajax({
                  url:`/Cart/remove/${orderId}?productId=${productId}`,
                  success: function(res){
                      showOrders()
                     ");
                WriteLiteral(@" if(res.cleared){
                          updateCartCount("""")
                      }else{
                          updateCartCount(res.count)
                      }
                  }
                 });
        }

        function updateCartCount(count){
            localStorage.setItem(""count"",count)
            document.dispatchEvent(new CustomEvent(""countChange""))
        }

    </script>
");
            }
            );
            WriteLiteral("\r\n");
        }
        #pragma warning restore 1998
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; } = default!;
        #nullable disable
    }
}
#pragma warning restore 1591
